<!DOCTYPE html>
<html lang="fr">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <title>Contact | AfriPropConnect</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{% static 'contact/style/style.css' %}">
    <!-- Unified AfriConnect Styles -->
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <!-- Main Header -->
    <header class="main-header">
        <a href="{% url 'real_estate:home' %}" class="logo">AfriConnect</a>
        <nav>
            <ul class="nav-links">
                <li><a href="{% url 'real_estate:home' %}">Accueil</a></li>
                <li><a href="{% url 'real_estate:property_list' %}">Propriétés</a></li>
                <li><a href="{% url 'land_services:land_services' %}">Services</a></li>
                <li><a href="{% url 'tourism:tourism' %}">Tourisme</a></li>
            </ul>
            <div class="menu-toggle" id="mobile-menu">
                <i class="fas fa-bars"></i>
            </div>
        </nav>
    </header>

    <!-- Mobile Navigation Menu (Hidden by default, toggled by JS) -->
    <nav class="mobile-nav" id="mobile-nav-links">
        <a href="{% url 'real_estate:home' %}">Accueil</a>
        <a href="{% url 'real_estate:property_list' %}">Propriétés</a>
        <a href="{% url 'land_services:land_services' %}">Services</a>
        <a href="{% url 'tourism:tourism' %}">Tourisme</a>
        <a href="#">Sénégal</a>
        <a href="#">Burundi</a>
        <a href="#">Rwanda</a>
        <a href="#">Gabon</a>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1>Contactez-Nous</h1>
            <p>Nous sommes là pour répondre à toutes vos questions et vous accompagner dans vos projets en Afrique.</p>
            <button class="cta-btn" onclick="document.getElementById('contact-form-section').scrollIntoView({behavior:'smooth'})">Envoyer un Message</button>
        </div>
    </section>

    <!-- Introduction and Contact Info -->
    <section class="section">
        <h2 class="section-title" style="color: var(--secondary);">Nous sommes à votre écoute</h2>
        <div class="intro-text">
            N'hésitez pas à nous contacter pour toute demande d'information, de service ou de partenariat. Notre équipe dédiée est prête à vous fournir l'assistance dont vous avez besoin.
        </div>

        <div class="contact-info-grid">
            <div class="info-card">
                <div class="icon"><i class="fas fa-envelope"></i></div>
                <h3>E-mail</h3>
                <p>Pour toute question générale ou demande d'information.</p>
                <a href="mailto:contact@afripropconnect.com">contact@afripropconnect.com</a>
            </div>
            <div class="info-card">
                <div class="icon"><i class="fas fa-phone-alt"></i></div>
                <h3>Téléphone</h3>
                <p>Disponible du lundi au vendredi, de 9h à 17h (heure locale).</p>
                <p>+250 788 123 456 (Rwanda)</p>
                <p>+221 77 123 45 67 (Sénégal)</p>
            </div>
            <div class="info-card">
                <div class="icon"><i class="fas fa-map-marker-alt"></i></div>
                <h3>Adresse</h3>
                <p>Nos bureaux principaux sont situés à Kigali.</p>
                <p>123 Rue de l'Innovation, Quartier des Affaires,</p>
                <p>Kigali, Rwanda</p>
            </div>
        </div>
    </section>

    <!-- Contact Form Section -->
    <section class="form-section" id="contact-form-section">
        <h2 style="color: var(--secondary);">Envoyez-nous un message</h2>
        <p>Utilisez le formulaire ci-dessous pour nous écrire directement. Nous vous répondrons dans les plus brefs délais.</p>
        <form class="contact-form" id="contactForm">
            {% csrf_token %} {# IMPORTANT: Django CSRF token #}
            <div>
                <label for="{{ form.name.id_for_label }}">Nom complet</label>
                {{ form.name }}
            </div>
            <div>
                <label for="{{ form.email.id_for_label }}">Adresse e-mail</label>
                {{ form.email }}
            </div>
            <div>
                <label for="{{ form.phone.id_for_label }}">Numéro de téléphone (optionnel)</label>
                {{ form.phone }}
            </div>
            <div>
                <label for="{{ form.subject.id_for_label }}">Sujet de votre demande</label>
                {{ form.subject }}
            </div>
            <div>
                <label for="{{ form.message.id_for_label }}">Votre message</label>
                {{ form.message }}
            </div>
            <button type="submit">Envoyer le message</button>
            <div class="message-box" id="responseMessage"></div>
        </form>
    </section>

    <!-- Location Map Section (Example for Kigali) -->
    <section class="section map-section">
        <h2 class="section-title" style="color: var(--secondary);">Retrouvez-nous sur la carte</h2>
        <iframe 
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15949.039209935147!2d30.05587785!3d-1.9440788!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x19d7b5b5b5b5b5b5%3A0x8e5e5e5e5e5e5e5e!2sKigali%2C%20Rwanda!5e0!3m2!1sen!2s!4v1678901234567!5m2!1sen!2s" 
            allowfullscreen="" 
            loading="lazy" 
            referrerpolicy="no-referrer-when-downgrade">
        </iframe>
    </section>

    <!-- FAQ -->
    <section class="section faq">
        <h2 class="section-title" style="color: var(--secondary);"><b>Foire Aux Questions</b></h2>
        <div class="faq-item">
            <div class="faq-question">Combien de temps faut-il pour obtenir une réponse ?</div>
            <div class="faq-answer">Nous nous efforçons de répondre à toutes les demandes dans un délai de 24 à 48 heures ouvrables.</div>
        </div>
        <div class="faq-item">
            <div class="faq-question">Puis-je prendre rendez-vous pour une consultation ?</div>
            <div class="faq-answer">Oui, vous pouvez demander un rendez-vous via le formulaire ou en nous contactant directement par téléphone ou e-mail.</div>
        </div>
        <div class="faq-item">
            <div class="faq-question">Quels sont vos horaires d'ouverture ?</div>
            <div class="faq-answer">Nos bureaux sont ouverts du lundi au vendredi, de 9h00 à 17h00 (heure locale de Kigali).</div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div>
            &copy; 2025 AfriPropConnect. Tous droits réservés. | <a href="{% url 'real_estate:home' %}">Accueil</a> | <a href="{% url 'contact:contact' %}">Contact</a> | <a href="#">Politique de Confidentialité</a>
        </div>
        <div style="margin-top:0.5rem;">
            Suivez-nous :
            <a href="#"><i class="fab fa-instagram"></i></a>
            <a href="#"><i class="fab fa-facebook"></i></a>
            <a href="#"><i class="fab fa-linkedin"></i></a>
        </div>
    </footer>

    <script>
        // JavaScript for mobile menu toggle
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuToggle = document.getElementById('mobile-menu');
            const mobileNavLinks = document.getElementById('mobile-nav-links');

            if (mobileMenuToggle && mobileNavLinks) {
                mobileMenuToggle.addEventListener('click', function() {
                    mobileNavLinks.classList.toggle('is-open');
                });
            }

            // JavaScript for Contact Form Submission (Conceptual - Requires Backend)
            const contactForm = document.getElementById('contactForm');
            const responseMessage = document.getElementById('responseMessage');

            if (contactForm && responseMessage) {
                contactForm.addEventListener('submit', async function(event) {
                    event.preventDefault(); // Prevent default form submission

                    responseMessage.style.display = 'none'; // Hide previous messages
                    responseMessage.classList.remove('error'); // Remove error class

                    // Simulate loading state
                    responseMessage.textContent = 'Envoi en cours...';
                    responseMessage.style.display = 'block';

                    const formData = new FormData(contactForm);
                    const data = Object.fromEntries(formData.entries());

                    // --- IMPORTANT: This is the actual backend endpoint for the contact app ---
                    const backendEndpoint = "{% url 'contact:submit_contact_form_api' %}"; 

                    try {
                        const response = await fetch(backendEndpoint, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'X-CSRFToken': getCookie('csrftoken'), // Include CSRF token for Django
                            },
                            body: JSON.stringify(data),
                        });

                        if (response.ok) {
                            const result = await response.json();
                            responseMessage.textContent = result.message || 'Votre message a été envoyé avec succès ! Nous vous répondrons bientôt.';
                            responseMessage.style.backgroundColor = '#d4edda'; // Success color
                            responseMessage.style.color = '#155724'; // Success text color
                            contactForm.reset(); // Clear the form
                        } else {
                            const errorResult = await response.json();
                            responseMessage.textContent = errorResult.message || 'Une erreur est survenue lors de l\'envoi de votre message. Veuillez réessayer.';
                            responseMessage.classList.add('error'); // Add error class for styling
                            responseMessage.style.backgroundColor = '#f8d7da'; // Error color
                            responseMessage.style.color = '#721c24'; // Error text color
                        }
                    } catch (error) {
                        console.error('Erreur réseau ou inattendue:', error);
                        responseMessage.textContent = 'Impossible de se connecter au serveur. Veuillez vérifier votre connexion ou réessayer plus tard.';
                        responseMessage.classList.add('error');
                        responseMessage.style.backgroundColor = '#f8d7da';
                        responseMessage.style.color = '#721c24';
                    }
                });
            }

            // Helper function to get CSRF token (for Django integration)
            function getCookie(name) {
                let cookieValue = null;
                if (document.cookie && document.cookie !== '') {
                    const cookies = document.cookie.split(';');
                    for (let i = 0; i < cookies.length; i++) {
                        const cookie = cookies[i].trim();
                        // Does this cookie string begin with the name we want?
                        if (cookie.substring(0, name.length + 1) === (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
                return cookieValue;
            }
        });
    </script>
</body>
</html>
